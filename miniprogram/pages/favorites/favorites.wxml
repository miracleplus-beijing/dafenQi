<!-- 收藏页面 - iOS 风格 -->
<view class="favorites-container">


  <!-- 未登录视图 -->
  <view class="login-view" wx:if="{{showLoginPrompt}}">
    <view class="login-hero">
      <view class="login-icon-wrapper">
        <t-icon name="heart" size="48px" />
      </view>
      <text class="login-title">查看我的收藏</text>
      <text class="login-subtitle">登录后可以收藏喜欢的播客和评论</text>
      <view class="login-features">
        <view class="feature-item">
          <view class="feature-icon">
            <t-icon name="check-circle" size="20px" />
          </view>
          <text class="feature-text">随时随地访问收藏内容</text>
        </view>
        <view class="feature-item">
          <view class="feature-icon">
            <t-icon name="check-circle" size="20px" />
          </view>
          <text class="feature-text">自动同步到云端</text>
        </view>
      </view>
      <button class="login-button" bindtap="goToLogin">
        立即登录
      </button>
    </view>
  </view>

  <!-- 已登录视图 -->
  <view class="favorites-content" wx:else>
    <!-- 标签页切换 -->
    <view class="tabs-container">
      <view class="tabs-wrapper">
        <view
          class="tab-item {{currentTab === 'episodes' ? 'active' : ''}}"
          bindtap="switchTab"
          data-tab="episodes"
        >
          <text class="tab-text">播客</text>
        </view>
        <view
          class="tab-item {{currentTab === 'comments' ? 'active' : ''}}"
          bindtap="switchTab"
          data-tab="comments"
        >
          <text class="tab-text">评论</text>
        </view>
      </view>
      <view class="tab-indicator" style="left: {{currentTab === 'episodes' ? '25%' : '75%'}}"></view>
    </view>

    <!-- 播客收藏列表 -->
    <view class="episodes-content" wx:if="{{currentTab === 'episodes'}}">
      <!-- 空状态 -->
      <view class="empty-state" wx:if="{{favoriteList.length === 0}}">
        <view class="empty-icon">
          <t-icon name="heart" size="64px" />
        </view>
        <text class="empty-title">暂无收藏</text>
        <text class="empty-desc">收藏喜欢的播客会显示在这里</text>
      </view>

      <!-- 收藏列表 -->
      <view class="favorites-list" wx:else>
        <view
          class="favorite-item"
          wx:for="{{favoriteList}}"
          wx:key="id"
          bindtap="playFavoriteItem"
          data-item="{{item}}"
        >
          <!-- 封面 -->
          <view class="item-cover">
            <image
              src="{{item.cover_url || 'https://gxvfcafgnhzjiauukssj.supabase.co/storage/v1/object/public/static-images/podcast_cover/default_cover.png'}}"
              class="cover-image"
              mode="aspectFill"
            />
            <view class="play-badge">
              <t-icon name="play-circle-filled" size="24px" />
            </view>
          </view>

          <!-- 内容信息 -->
          <view class="item-info">
            <text class="item-title">{{item.title}}</text>
            <text class="item-channel">{{item.hosts || item.channel || '未知主播'}}</text>
            <view class="item-meta">
              <view class="meta-item">
                <t-icon name="time" size="14px" />
                <text class="meta-text">{{item.durationText || '未知时长'}}</text>
              </view>
              <view class="meta-divider">·</view>
              <view class="meta-item">
                <t-icon name="play-circle" size="14px" />
                <text class="meta-text">{{item.playCountText || '0'}}</text>
              </view>
            </view>
          </view>

          <!-- 操作按钮组 -->
          <view class="item-actions">
            <!-- 分享按钮 -->
            <view class="share-btn" catchtap="shareItem" data-item="{{item}}">
              <t-icon name="share" size="18px" />
            </view>
            <!-- 取消收藏按钮 -->
            <view class="unfavorite-btn" catchtap="removeFromFavorites" data-id="{{item.id}}">
              <t-icon name="heart-filled" size="20px" />
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- 评论收藏列表 -->
    <view class="comments-content" wx:else>
      <!-- 空状态 -->
      <view class="empty-state">
        <view class="empty-icon">
          <t-icon name="chat" size="64px" />
        </view>
        <text class="empty-title">暂无收藏</text>
        <text class="empty-desc">收藏精彩的评论会显示在这里</text>
      </view>
    </view>
  </view>
</view>