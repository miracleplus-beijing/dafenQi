<!-- 历史记录页面 - iOS 风格 -->
<view class="history-container">
  <!-- 导航栏 -->
  <view class="nav-bar">
    <view class="nav-content">
      <view class="nav-back" bindtap="goBack">
        <t-icon name="chevron-left" size="24px" />
      </view>
      <text class="nav-title">收听历史</text>
      <view class="nav-placeholder"></view>
    </view>
  </view>

  <!-- 加载状态 -->
  <view class="loading-state" wx:if="{{loading}}">
    <t-loading size="large" text="加载中..." />
  </view>

  <!-- 空状态 -->
  <view class="empty-state" wx:elif="{{historyList.length === 0}}">
    <view class="empty-icon">
      <t-icon name="history" size="64px" />
    </view>
    <text class="empty-title">暂无播放历史</text>
    <text class="empty-desc">听过的内容会显示在这里</text>
  </view>

  <!-- 历史列表 -->
  <view class="history-content" wx:else>
    <!-- 统计信息 -->
    <view class="stats-card">
      <view class="stats-item">
        <text class="stats-number">{{historyList.length}}</text>
        <text class="stats-label">播放记录</text>
      </view>
    </view>

    <!-- 列表区域 -->
    <view class="history-list">
      <view
        wx:for="{{historyList}}"
        wx:key="id"
        class="history-item"
        bindtap="playHistoryItem"
        data-item="{{item}}"
      >
        <!-- 封面 -->
        <view class="item-cover">
          <image
            src="{{item.cover || 'https://gxvfcafgnhzjiauukssj.supabase.co/storage/v1/object/public/static-images/podcast_cover/defult_cover.png'}}"
            class="cover-image"
            mode="aspectFill"
          />
          <view class="play-badge">
            <t-icon name="play-circle-filled" size="24px" />
          </view>
        </view>

        <!-- 内容信息 -->
        <view class="item-info">
          <text class="item-title">{{item.title}}</text>
          <text class="item-channel">{{item.channel}}</text>

          <view class="item-meta">
            <view class="meta-item">
              <t-icon name="time" size="14px" />
              <text class="meta-text">{{item.playTimeText}}</text>
            </view>
            <view class="meta-divider">·</view>
            <view class="meta-item">
              <t-icon name="play-circle" size="14px" />
              <text class="meta-text">{{item.stats.playCount}}</text>
            </view>
          </view>

          <!-- 状态标签 -->
          <view class="item-status" wx:if="{{item.completed || item.progressPercent > 0}}">
            <text class="status-badge completed" wx:if="{{item.completed}}">已完成</text>
            <text class="status-badge in-progress" wx:else>进行中</text>
          </view>
        </view>

        <!-- 删除按钮 -->
        <view class="item-action">
          <view
            class="delete-btn"
            catchtap="removeFromHistory"
            data-id="{{item.id}}"
          >
            <t-icon name="delete" size="20px" />
          </view>
        </view>
      </view>
    </view>

    <!-- 底部清空按钮 -->
    <view class="bottom-actions">
      <button class="clear-button" bindtap="clearAllHistory">
        <t-icon name="delete" size="18px" />
        <text>清空全部历史</text>
      </button>
    </view>
  </view>
</view>