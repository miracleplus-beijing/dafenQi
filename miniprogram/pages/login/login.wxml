<!-- 登录页面 - 全新设计 -->
<view class="content">
  <!-- 背景装饰 -->
  <view class="bg"></view>
  <view class="bg2"></view>
  
  <!-- Logo区域 -->
  <view class="logo-section">
    <image src="https://gxvfcafgnhzjiauukssj.supabase.co/storage/v1/object/public/static-images/icons/logo.png" class="app-logo" mode="aspectFit"></image>
    <text class="app-name">达芬Qi说</text>
    <text class="app-slogan">听见学术的声音</text>
  </view>

  <!-- 登录标题区域 -->
  <view class="tips">
    <text class="title">登录</text>
    <text class="subtitle">听见学术的声音</text>
  </view>
  
  <!-- 表单区域 -->
  <view class="form-box">
    <!-- 微信登录按钮 -->
    <view wx:if="{{!showUserInfoForm}}" class="login-btn" bindtap="handleWechatLogin">
      <image class="login-icon" src="https://gxvfcafgnhzjiauukssj.supabase.co/storage/v1/object/public/static-images/icons/wechat.svg"></image>
      <text class="login-text">微信登录</text>
    </view>

    <!-- 用户信息设置表单 -->
    <view wx:if="{{showUserInfoForm}}" class="user-info-section">
      <view class="form-title">完善个人信息</view>

      <!-- 头像选择 - 完全复刻avatar_nickname -->
      <button class="avatar-wrapper" id="chooseAvatarBtn" open-type="chooseAvatar"
       bind:chooseavatar="onChooseAvatar">
        <image class="avatar" src="{{avatarUrl}}"></image>
      </button>

      <!-- 昵称输入 - 完全复刻avatar_nickname -->
      <view class="nickname-section">
        <text class="nickname-label">昵称</text>
        <input type="nickname" class="nickname-input" placeholder="请输入昵称" value="{{nickname}}" bindinput="onNicknameChange"/>
      </view>

      <!-- 完成按钮 -->
      <button class="complete-btn" bindtap="completeUserInfo">完成设置</button>
    </view>

    <!-- 其他操作 -->
    <view wx:if="{{!showUserInfoForm}}" class="other-actions">
      <text bindtap="handleGuestMode">游客浏览</text>

    </view>

    <!-- 协议同意 -->
    <view wx:if="{{!showUserInfoForm}}" class="agreement-section">
      <view class="agreement-checkbox" bindtap="toggleAgreement">
        <image 
          src="{{isAgreed ? 'https://gxvfcafgnhzjiauukssj.supabase.co/storage/v1/object/public/static-images/icons/login-agree-checked.svg' : 'https://gxvfcafgnhzjiauukssj.supabase.co/storage/v1/object/public/static-images/icons/login-agree-unchecked.svg'}}" 
          class="checkbox-icon"
        ></image>
        <text class="agreement-text">登录即同意<text class="link-text" catchtap="showUserAgreement">《用户协议》</text>和<text class="link-text" catchtap="showPrivacyPolicy">《隐私政策》</text></text>
      </view>
    </view>
  </view>
  
  <!-- 底部装饰 -->
  <view class="bottom-decoration">
    <text class="copyright">© 2024 达芬Qi说 版权所有</text>
  </view>
</view>