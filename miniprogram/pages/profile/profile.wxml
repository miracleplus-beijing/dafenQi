<!-- 我的页面 -->
<view class="profile-container">
  
  <!-- 1. 用户信息区域 (已登录) -->
  <view class="user-header" wx:if="{{isLoggedIn}}">
    <view class="user-info-left">
      <text class="user-name" bindtap="changeUserName">{{userInfo.nickName || '用户'}}</text>
      <text class="user-desc" wx:if="{{userInfo.id}}">ID: {{userInfo.id}}</text>
      <text class="user-desc" wx:else>点击设置昵称</text>
    </view>
    
    <button class="avatar-btn" open-type="chooseAvatar" bind:chooseavatar="onChooseAvatar">
      <image class="avatar-img" src="{{userInfo.avatarUrl || 'https://gxvfcafgnhzjiauukssj.supabase.co/storage/v1/object/public/static-images/icons/user.svg'}}" mode="aspectFill" />
    </button>
  </view>

  <!-- 2. 菜单列表 (已登录) - 使用 TDesign Cell -->
  <view class="menu-card" wx:if="{{isLoggedIn}}">
    <t-cell-group theme="card">
      <t-cell title="收听历史" leftIcon="time" hover arrow bindtap="handleMenuClick" data-type="history" />
      <t-cell title="我的收藏" leftIcon="heart" hover arrow bindtap="handleMenuClick" data-type="favorites" />
      <t-cell title="我的评论" leftIcon="chat" hover arrow bindtap="handleMenuClick" data-type="comments" />
      <t-cell title="设置" leftIcon="setting" hover arrow bindtap="handleMenuClick" data-type="settings" />
    </t-cell-group>
  </view>



  <!-- 4. 未登录状态 - 精美登录卡片 -->
  <view class="login-container" wx:if="{{!isLoggedIn}}">
    <view class="login-card">
      <view class="login-icon-bg">
        <image src="https://gxvfcafgnhzjiauukssj.supabase.co/storage/v1/object/public/static-images/icons/user.svg" class="login-icon"></image>
      </view>
      
      <text class="login-title">登录解锁更多功能</text>
      
      <view class="login-benefits">
        <view class="benefit-item">
          <t-icon name="check" size="32rpx" color="var(--color-success)" />
          <text class="benefit-text">同步收藏和历史记录</text>
        </view>
        <view class="benefit-item">
          <t-icon name="check" size="32rpx" color="var(--color-success)" />
          <text class="benefit-text">个性化推荐内容</text>
        </view>
        <view class="benefit-item">
          <t-icon name="check" size="32rpx" color="var(--color-success)" />
          <text class="benefit-text">跨设备数据同步</text>
        </view>
      </view>
      
      <t-button theme="primary" size="large" block class="login-btn" bindtap="handleLogin">立即登录</t-button>
    </view>
  </view>

  <!-- 触摸反馈 -->
  <view class="touch-feedback" wx:if="{{showSwipeIndicator}}">
    <view class="swipe-indicator left {{swipeDirection === 'left' ? 'active' : ''}}"></view>
    <view class="swipe-indicator right {{swipeDirection === 'right' ? 'active' : ''}}"></view>
  </view>
</view>
